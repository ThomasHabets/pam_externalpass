Intro
=====
This code is for the authenticator client. E.g. a server that is to be
logged into.


Installing
==========
1) run "./configure"
2) run "make"
3) run "make install"
3) copy auth.py to a good place, like /usr/local/sbin, or use your own
   authenticator.


Configuring
===========
Put this *before* the pam_unix line in /etc/pam.d/ssh (or
/etc/pam.d/common-auth on debian for all login methods):
  auth sufficient /usr/local/lib/libpam_externalpass.so \
           exec=/.../auth.py \
           prompt=Yubikey:_ \
           userconf=%h/.yubikeys

(on one line, and no backslashes)

Make sure your /etc/ssh/sshd_config (or equivalent) has:
  ChallengeResponseAuthentication yes
  UsePAM yes
... or at least not "no". You'll know this is wrong if you never get a Yubikey
prompt when you log in.

The optional userconf parameter is used to check if there is even a
point to running the script. If the parameter is used then that file
must exist, or pam_externalpass will ask for a password or run the
external authenticator.

This has been tested on FreeBSD and Linux (debian).


Local auth
----------
If you want the server you log in to to do the authentication locally then
use another auth.py script. An example would be to run yoracle.py script
from yoracle (git clone http://cvs.habets.pp.se/~marvin/git/yoracle.git).


Config per-user
===============
Put a list of keys and authservers in a users ~/.yubikeys. For example this
line would be to authenticate key xxxaaaxxxaaa agains authserver.example.com
which is running a yoracle on port 80:
   xxxaaaxxxaaa http://authserver.example.com/auth/0/?token=%(token)s

(the key id is the first 12 characters of every token you generate)

The authenticator client currently only works with my yoracle
authenticator. I will add support for the official protocol when I get
around to it. It won't take long, but nobody (even I) have said that
they need it.


P.S.
====
Thank you for adding support for dvorak to your yubikey apps. All my yubikey
stuff (including this code) has support for it.
